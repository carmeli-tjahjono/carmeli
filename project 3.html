<!DOCTYPE HTML>
<!--
	Read Only by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Carmeli-Dannys Diner by Danny Ma</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Header -->
			<section id="header">
				<header>
					<span class="image avatar"><img src="images/" alt="" /></span>
					<h1 id="logo"><a href="#">Carmeli Tjahjono</a></h1>
					<p>Data Analyst & Visualization
						Restaurant Management<br />
					</p>
				</header>
				<nav id="nav">
					<ul>
						<li><a href="index.html" class="active">Home</a></li>
						<li><a href="project 2.html">Previous Project</a></li>
						<li><a href="project 4.html">Next Project</a></li>
                    </ul>
				</nav>
				<footer>
					<ul class="icons">
						<li><a href="www.linkedin.com/in/carmeli-tjahjono" class="icon brands fa-linkedin"><span class="label">Linked In</span></a></li>
						<li><a href="https://github.com/carmeli-tjahjono" class="icon brands fa-github"><span class="label">Github</span></a></li>
						<li><a href="mailto: carmeli.tjahjono@gmail.com" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
					</ul>
				</footer>
			</section>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">

						<!-- One -->
							<section id="one">
								<div class="container">
									<header class="major">
										<h2></h2>
										<p>Danny Ma's SQL Challenge<br />
											</p>
									</header>
									<span class="image featured"><img src="images/8WkSQLChallenge/Dannys Diner.png"width="350"height="350" alt="" /></span>
									<p> SQL project where I worked through the 10 questions in this case study by Danny Ma.
										<p> Problem Statement:
											<br>Dannys Diner wants to use the data to answer a few simple questions about his customers, especially about their visiting patterns, how much money theyâ€™ve spent and also which menu items are their favourite.
											<p>More about this case study: <a href="https://8weeksqlchallenge.com/case-study-1/" class="action">Dannys Diner</a> 
									<p>See my <a href="https://github.com/carmeli-tjahjono/Danny-Ma-SQL-Challenge/blob/main/Case%20Study%20%231%20Tables%20%26%20Solutions.md" class=""action"> full solution on github</a>
									<p>Here is couple questions and my solutions:
										
									<p>1. What is the total amount each customer spent at the restaurant? 
										<br>SELECT customer_id, SUM(product_id*price) AS total_spent
										<br>FROM dannys_diner.sales
										<br>JOIN dannys_diner.menu
										<br>USING (product_id)
										<br>GROUP BY customer_id
										<br>ORDER BY customer_id
										<br><span class="image"><img src="images/8WkSQLChallenge/Q1.png"width="300"height="200" alt="" /></span>
									<br>2. How many days has each customer visited the restaurant?
										<br>SELECT customer_id, COUNT(DISTINCT order_date) as total_days
										<br>FROM dannys_diner.sales
										<br>GROUP BY customer_id
										<br><span class="image"><img src="images/8WkSQLChallenge/Q2.png"width="300"height="200" alt="" /></span>
									<br>3. What was the first item from the menu purchased by each customer?
										<br>SELECT customer_id, product_name, rank
										<br>FROM (
										<br>&emsp; SELECT customer_id, product_id, 
										<br>&emsp;	DENSE_RANK () OVER (PARTITION BY customer_id ORDER BY order_date) AS rank
										<br>&emsp;	FROM dannys_diner.sales
										<br>&emsp;	GROUP BY customer_id, product_id, order_date
										<br>) AS rank_table
										<br>JOIN dannys_diner.menu
										<br>USING (product_id)
										<br>WHERE rank =1
										<br>ORDER BY customer_id
										<br><span class="image"><img src="images/8WkSQLChallenge/Q3.png"width="400"height="200" alt="" /></span>
									<br>4. What is the most purchased item on the menu and how many times was it purchased by all customers?
										<br>SELECT product_name, COUNT (product_id)
										<br>FROM dannys_diner.sales
										<br>JOIN dannys_diner.menu
										<br>USING (product_id)
										<br>GROUP BY product_name
										<br>ORDER BY count DESC
										<br>LIMIT 1
										<br><span class="image"><img src="images/8WkSQLChallenge/Q4.png"width="250"height="100" alt="" /></span>
									<br>5. Which item was the most popular for each customer?
										<br>WITH rank AS (
										<br>  &emsp;SELECT customer_id, product_name, COUNT(product_id),
										<br>  &emsp;DENSE_RANK () OVER (PARTITION BY customer_id ORDER BY product_id DESC) as rank
										<br>  &emsp;JOIN dannys_diner.sales
										<br>  &emsp;USING (product_id)
										<br>  &emsp;GROUP BY customer_id, product_id, product_name
										<br>  &emsp;)

										<p>  SELECT customer_id, product_name, count
										<br>  FROM rank
										<br>  WHERE rank = 1
										<br><span class="image"><img src="images/8WkSQLChallenge/Q5.png" width="400" height="200" alt="" /></span>
																		
								</div>
							</section>



						


		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
